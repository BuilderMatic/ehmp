<!DOCTYPE html>
<html>
<title>Applet Development Kit (ADK)</title>

<xmp style="display:none;" toc toc-top-link="back to top" title="Using the Application Development Kit" description="API calls, utils, helpers, components, and views">

### ResourceService ###
ADK.ResourceService(_options_)

Importing the ADK resource and using ADK.ResourceService allows you to perform fetches against any resource from the ResourceDirectory.
- ADK.ResourceService.**fetchCollection(options)** - returns a Backbone Collection of the requested resource
- ADK.ResourceService.**fetchModel(options)** - returns a Backbone Model
- ADK.ResourceService.**createEmptyCollection(options)** - returns an empty Backbone Collection of the requested resource
- ADK.ResourceService.**buildUrl(resourceTitle, criteria)** - returns a URL from the resource directory

**options**
- resourceTitle - resource title from resource directory
- [pageable] - returns Backbone.PageableCollection when true
- [collectionConfig] - collection config passed to constructor
- [collectionConfig.collectionParse(collection)] - collection parse override
- [viewModel] - view model to override model parse
- [criteria] - criteria key value pairs converted to query string parameters on fetch URL
- [cache] - fetch from cache when true, bypass/expire cache when false. (default false)
- [cacheExpiration] - cache expiration in seconds or false for never expires.  (default 10 minutes)

**collectionConfig.collectionParse**

Receives a collection and returns an Object Array to override default collection parse.

```JavaScript
fetchOptions.collectionConfig = {
        collectionParse: function(collection) {
            return collection.where({
                summary: 'CHOCOLATE'
            });
        }
    };
```

**paging criteria** (see resource directory for applicable resources)
- start - start showing results from this 0-based index
- limit - show this many results

```JavaScript
var dependencies = [
    "ADK",
    ...
];
define(dependencies, onResolveDependencies);
function onResolveDependencies(ADK, ...) {
    ...
    var fetchOptions = {
      cache: true,
      resourceTitle: 'some-resource-title', //resource title from resource directory
      viewModel: viewModel, //optional override of default viewModel
      criteria: criteria //optional criteria object gets converted to query string parameters on resource call
    };
    resourceCollection = ADK.ResourceService.fetchCollection(fetchOptions);
    resourceModel = ADK.ResourceService.fetchModel(fetchOptions);
}
```

**filter criteria** (see JDS documentation for filter syntax https://wiki.vistacore.us/x/X5cx)
- filter - criteria option for passing JDS filter

```JavaScript
criteria = {
  filter: 'lte(overallStart,"2013"),gte(overallStop,"2015")'
}
```

**sort criteria**
- order - criteria option for passing JDS sort order

```JavaScript
criteria = {
  order: 'overallStop DESC'
}
```
<br/>

### PatientRecordService ###
ADK.PatientRecordService(_options_)

ADK.PatientRecordService acts similar to ADK.ResourceService except it allows you to fetch resources from the ResourceDirectory in regards to a particular patient by passing in a patient attribute as part of the options parameter.
- ADK.PatientRecordService.**fetchCollection(options)** - returns a Backbone Collection of the requested resource
- ADK.PatientRecordService.**fetchModel(options)** - returns a Backbone Model
- ADK.PatientRecordService.**getCurrentPatient()** - returns a patient Backbone Model of the current selected patient.

**options**
- [patient] - patient object
- resourceTitle - resource title from resource directory
- [pageable] - returns Backbone.PageableCollection when true
- [collectionConfig] - collection config passed to constructor
- [collectionConfig.collectionParse(collection)] - collection parse override
- [viewModel] - view model to override model parse
- [criteria] - criteria key value pairs converted to query string parameters on fetch URL
- [cache] - fetch from cache when true, bypass/expire cache when false. (default true)
- [cacheExpiration] - cache expiration in seconds or false for never expires.  (default 10 minutes)

**collectionConfig.collectionParse**

Receives a collection and returns an Object Array to override default collection parse.

```JavaScript
fetchOptions.collectionConfig = {
        collectionParse: function(collection) {
            return collection.where({
                summary: 'CHOCOLATE'
            });
        }
    };
```

**paging criteria** (see resource directory for applicable resources)
- start - start showing results from this 0-based index
- limit - show this many results

```JavaScript
var dependencies = [
    "ADK",
    ...
];
define(dependencies, onResolveDependencies);
function onResolveDependencies(ADK, ...) {
    ...
    var fetchOptions = {};

    //Pick one of the approaches based on what patient you would like to receive the resource data on
        fetchOptions.patient = ADK.PatientRecordService.getCurrentPatient();  //optional, defaults to current patient context
    // OR
        var sample-patient-model = Backbone.Model.extend({pid: "...."});
        fetchOptions.patient = sample-patient-model;
    //

    fetchOptions.resourceTitle = 'patient-record-med';  //resource title from resource directory
    fetchOptions.viewModel = viewModel;  //optional override of default viewModel
    fetchOptions.pageable = true; //optional to return Backbone.PageableCollection
    fetchOptions.collectionConfig = {};  //options config object for collection constructor attributes
    fetchOptions.criteria = criteria;  //optional criteria object gets converted to query string parameters on resource call
    medicationCollection = ADK.PatientRecordService.fetchCollection(fetchOptions);
}
```

**filter criteria** (see JDS documentation for filter syntax https://wiki.vistacore.us/x/X5cx)
- filter - criteria option for passing JDS filter

```JavaScript
criteria = {
  filter: 'lte(overallStart,"2013"),gte(overallStop,"2015")'
}
```

**sort criteria**
- order - criteria option for passing JDS sort order

```JavaScript
criteria = {
  order: 'overallStop DESC'
}
```
<br/>

### UserService ###
ADK.UserService()

- **ADK.UserService.getUserSession()** - Returns the current Session.user object

	```JavaScript
	var session = ADK.UserService.getUserSession();
	    session = {
          "site": "9E7A",
          "expires": "2015-02-26T19:53:36.301Z",
          "status": "loggedin",
          "disabled": false,
          "divisionSelect": false,
          "duz": {
              "9E7A": "10000000227"
          },
          "facility": "PANORAMA",
          "firstname": "PANORAMA",
          "lastname": "USER",
          "permissions": [],
          "requiresReset": false,
          "section": "Medicine",
          "title": "Clinician",
          "provider": true,
          "infoButtonPanorama": "1.3.6.1.4.1.3768",
          "infoButtonKodak": "1.3.6.1.4.1.2000",
          "infoButtonSite": "www.somesite.com"
      }
	```

- **ADK.UserService.authenticate(userName, password, resourceTitle)**
	- **userName**: The username to authenticate
	- **password**: The password to authenticate
	- **resourceTitle**: Name of the resource in the resource directory to call against

	Sets the current session on success of authenticating the supplied userName and password against the resourceTitle.
	- Returns **_true_**  if successful at authenticating and setting the user session
	- Returns **_false_** otherwise

	```JavaScript
	if (ADK.UserService.authenticate(userName, password, appletDefinition.resource)) {
	    console.log("Successfully authenticated");
	}
	else {
	    console.log("Failed to authenticate");
	}
	```

- **ADK.UserService.clearUserSession()** - Clears the UserSession.
	- Returns **_true_** if successful
	- Returns **_false_** otherwise

- **ADK.UserService.hasPermission(permission)** - Checks user permission.
  - Returns **_true_** if user has permission
  - Returns **_false_** otherwise
  - Handlebar helper available for use in template

  ```JavaScript
  If (ADK.UserService.hasPermission('edit-patient-record')) {
    dataGridOptions.onClickAdd = â€¦
  }
  ```
<br/>

### Navigation ###
- **ADK.Navigation.navigate(screenName)** - Changes screen and updates URL

	```JavaScript
	ADK.Navigation.navigate("allergy-list");
	```

- **ADK.Navigation.displayScreen(screenName)** - Changes screen and does not update URL

	```JavaScript
	ADK.Navigation.displayScreen("allergy-list");
	```
<br/>

### Messaging ###
- **ADK.Messaging** - The global Backbone.Radio channel [Backbone.Radio docs][BackboneRadio]
- **ADK.Messaging.getChannel(channelName)** - Get a channel private to a specific applet for communicating with that applet only

	```JavaScript
	ADK.Messaging.on("<someGlobalEvent>", function(...) {...});
  ...
  var allergiesChannel = ADK.Messaging.getChannel('<theAllergyAppletId>');
  var resultOfRequest = allergies.request("<someAllergyRequest>", optionalParameter);
  ...
  var someAppletChannel = ADK.Messaging.getChannel('someAppletId');
  someAppletChannel.comply("someCommandName", function() {});
	```
  Be sure to read the docs ([Backbone.Radio][BackboneRadio]) to understand all of the differences between events, requests, and commands. For instance, you can have many listeners for a given *event* on a given channel, but only *one* listener for a given *command* on a given channel (registering a new listener for command B on channel A will overwrite any previous listener for command B on channel A).

<br/>

### SessionStorage ###
- **ADK.SessionStorage.setAppletStorageModel(appletId, key, value)** - Adds a key/value property into the given appleId from 'appletStorage' object in a web browser's Session Storage.
  ```JavaScript
  ADK.SessionStorage.setAppletStorageModel('lab_results_grid', 'key1', 'value1');
  ```
  where the browser's Session Storage stores it in JSON format like
  ```JavaScript
    appletStorage: {
      'lab_results_grid': {
        'key1': 'value1'
      }
    }
  ```

- **ADK.Messaging.getAppletStorageModel(appletId, key)** - Retrieves a value of the given key from the given appletId from 'appletStorage' object in a web browser's Session Storage.
  ```JavaScript
  var myValue = ADK.SessionStorage.getAppletStorageModel('lab_results_grid', 'key1');
  ```

<br />

## ADK Utilities ##
---

The following are the available utilities that have been created thus far in the ADK:

### Extract ###

The default response from the PatientRecordService is the VPR JSON format.  In many cases you may want to flatten or simplify the model for use in a view template.  The model is overridden by passing in an optional viewModel parameter including a new parse method to the PatientRecordService.

**ADK.utils.extract(obj, expr, args)**
- _obj_ - object representing the response
- _expr_ - path expression
- _args_ - key value pairs in which the 'key' is used to assign a new param to response, and the 'value' is the name of the value being assigned to the new param.

```JavaScript
var viewModel = {
    parse: function(response) {
        if (response.reactions) {
            response = ADK.utils.extract(response, response.reactions[0], {reaction:"name"});
        }
        return response;
    }
};
```

<br />

### Sort Collection ###

**ADK.utils.sortCollection(collection, key, sortType, ascending)**
- _collection_ - The collection to be sorted
- _key_ - The key to sort by
- _sortType_ - Alphabetical, Alphanumerical, Numerical
- _ascending_ - Boolean: True for sorting. False for reverse sorting

```JavaScript
sortCollection: function(collection, key, sortType, ascending) {
    ADK.utils.sortCollection(collection, key, sortType, ascending);
}
```

<br />

### Filter Collection ###

The following collection filters are available for convenience.  However, backbone collections have a built in filter method based on Underscore, [Underscore][underscoreFilterWebPage].

**ADK.utils.resetCollection(collection)**
- _collection_ - The collection to be reset

**ADK.utils.filterCollectionByDays(collection, numberOfDays, dateKey)**
- _collection_ - The collection to be filtered
- _numberOfDays_ - The key to sort by
- _dateKey_ - the model key of the date field to filter on

**ADK.utils.filterCollectionByDateRange(collection, startDate, endDate, dateKey)**
- _collection_ - The collection to be filtered
- _startDate_ - JavaScript Date object of Start range
- _endDate_ - JavaScript Date object of End range
- _dateKey_ - the model key of the date field to filter on

**ADK.utils.filterCollectionBeginsWith(collection, key, filterValue)**
- _collection_ - The collection to be filtered
- _key_ - the model key of the field to filter on
- _filterValue_ - the string value to filter by

**ADK.utils.filterCollectionByValue(collection, key, filterValue)**
- _collection_ - The collection to be filtered
- _dateKey_ - the model key of the field to filter on
- _filterValue_ - the string value to filter by

<br />

## Handlebar Helpers ##
---

### Template Helpers ###
**Found In:** production/_assets/templates/helpers/

The following are the available handlebar helpers that have been created thus far in the ADK:
- Format Date -  {{**formatDate** _displayFormat sourceFormat_ }}

	```Handlebars
	<span>{{formatDate dateOfBirth}}</span>
	<span>{{formatDate dateOfBirth "YYYY-MM-DD"}}</span>
	<span>{{formatDate dateOfBirth "YYYY-MM-DD" "DDMMYYYY"}}</span>
	```

- Format SSN -  {{**formatSSN** _ssn mask_ }}

	```Handlebars
	<span>{{formatSSN ssn}}</span>
	<span>{{formatSSN ssn true}}</span>
	<span>{{formatSSN ssn false}}</span>
	```

- Get Age -  {{**getAge** _sourceFormat_ }}

	```Handlebars
	<span>{{getAge dateOfBirth}}y</span>
	<span>{{getAge dateOfBirth "DDMMYYYY"}}</span>
	```

- hasPermission -  {{**hasPermission** _permission_ }}

  ```Handlebars
  {{#hasPermission 'edit-patient-record'}}
  <button>Add</button>
  {{/hasPermission}}
  ```

<br />

## ADK Components ##
---

The following are the available components that have been created thus far in the ADK:

### Modal (window)###

#### Create clickable item ####

Add a unique id to the HTML tag.  See example below:

```HTML
<button id="modalButton">CLICK ME</button>
```

#### Tie clickable item to event function####
Under the events field in the extend Backbone ItemView use the unique id assign to the clickable item to listen for a click event.
The event should call a function that creates your new instance of your modal view and assigned this.model to be the model for that view.
Finally use the ADK.showModal() function to display the view.  (see below)

```JavaScript
events: {
    'click #modalButton': 'showModal'
},
showModal: function(event) {
    event.preventDefault(); //prevent the page from jumping back to the top

    //Note: the view shown in the modal window can be any view
    var view = new exampleView();
    view.model = this.model;

    //Note: this is optional and only an example.
    //      This example creates a view that has a "Exit" button, that will be displayed in the modal's footer
    var footerView = Backbone.Marionette.ItemView.extend({
        template: _.template("<button type='button' class='btn btn-default' data-dismiss='modal'>Exit</button>")
    });

    //Note: this is optional and only an example.
    //Specifying your own header view will remove the default x-close button -> create your own if needed
    // This example creates a view that has a title as well as a "Previous" and "Next" button
    var headerView = Backbone.Marionette.ItemView.extend({
        template: _.template("<h1>Hi I'm a Modal Header</h1><button type='button' class='btn btn-default'>Previous</button><button type='button' class='btn btn-default'>Next</button>")
    });

    //Note: passing in modalOptions is optional
    var modalOptions = {
        'title': this.model.get('name'),
        'size': "medium",
        'backdrop': true,
        'keyboard': true,
        'callShow': true,
        'headerView': headerView,
        'footerView': footerView
    }
    ADK.showModal(view, modalOptions);
}
```
>! _*Note:_ **ADK.showModal(view, modalOptions)** can take in two parameters.
- The first parameter is the **view** that gets shown in the modal: _required_
- The second paramter is an object variable with the **modalOptions**: _optional_
  - valid options include:
    - **"title"**  (_optional_)
      -  displays a string as the title to the modal
    - **"size"** (_optional_)
      - valid modal sizes include: "xlarge" | "large" | "medium"
      - default size: **"medium"**
    - **"backdrop"** (_optional_)
      - Includes a modal-backdrop element. Alternatively, specify static for a backdrop which doesn't close the modal on click.  true | false | "static"
      - default: **true**
    - **"keyboard"** (_optional_)
      - Closes the modal when escape key is pressed: true | false
      - default: **true**
    - **"callShow"** (_optional_)
      - Shows the modal when initialized: true | false
      - default: **"true"**
      - If the developer wishes to issue $("#mainModal").modal('show') or use data-toggle this MUST be set to false
    - **"footerView"** (_optional_)
      - overwrites the default modal footer (close button) with a specified view
    - **"headerView"** (_optional_)
      - overwrites the default modal header (x-close button and title) with a specified view

>! **Note**: When ADK.showModal(view, modalOptions) is issued by some method other than an element with the data-toggle="modal" data-target="#modalElement" (such as through the channeling service or JavaScript), the modal must have the 'callShow' option set to true.

>! **Also Note**: The ADK.showModal() method returns the modal Layout View which includes modal-header, modal-body and modal-footer.

<br />

### Workflow Modal (window)###

#### Overview ####
A Workflow Modal is a collection of modals that represent a writeback applet. Unlike a modal, which is a singleton and will destroy its make-up views when it is hidden, a workflow allows a developer to open multiple modals and persist the DOM elements until the workflow is abandonded or completes successfully. Since a workflow is an extension of Modal, it shares the same templates and basic functionality.

The first thing to note is that a workflow should always be triggered programatically. Any button that either initiates the workflow, or adds another item to the workflow, needs to use event binding that triggers ADK.showWorkflowItem. Do not set 'data-toggle="modal" data-target="#mainModal"'' on the DOM element. This will cause unwanted behavior and is not supported.

#### Usage ####
Programatically, the most signifiant deviation from the functionality of ADK.showModal is that a workflow requires a regionName to be specified in the options. A typical invokation is as follows:

```JavaScript
var workflowOptions =  {
    'title': 'someTitle',
    'headerView': myHeaderView,
    'footerView': myFooterView,
    //The following parameter is required and must be unique per view instance
    'regionName': 'addEditViewName'
};

ADK.showWorkflowItem(myViewInstance, workFlowOptions);
```

Every time ADK.showWorkflowItem is called with a new 'regionName', a new item is added to the workflow and displayed if 'callShow' is not explicitly set to false. If the 'regionName' already exists, the workflow item is simply made visible and all others hidden, unless 'replaceContents' is set to the true, and in that case, the view belonging to the supplied 'regionName' is destroyed and a new view instance is created and attached.

If regions have been specified, a developer may optionally choose to use events to show certain items within the workflow. If a channel is not specified in the options, the 'channel' will be 'workflowChannel', and issuing show via the channel would be accomplished as follows:

```JavaScript
ADK.Messaging.getChannel('workflowChannel').trigger('show:' + regionName);
```

Once the item is displayed an any animations are complete, an event will be triggered that allows the user to know the item is visible:

```JavaScript
ADK.Messaging.getChannel('workflowChannel').on('shown:' + regionName, function(event) { //do something });
```

There are two ways to terminate a workflow. Like Modal, a developer can apply 'data-dismiss="modal"'' to a button and by default a click will close the workflow and destroy all associated views. Programatically, a developer can issue a ADK.closeWorkflow() call (for instance, in a 'success' callback) which will also terminate a workflow and destroy all views.

>! _*Note:_ **ADK.showWorkflowItem(view, modalOptions)** can take in two parameters.
- The first parameter is the **view** that gets shown in the modal: _required_
- The second paramter is an object variable with the **modalOptions**: _required_
  - valid options include:
    - **"regionName"**  (_required_)
      -  A unique identifier that determines which region within the parent container the current view will occupy. The region will be
         dynamically added if it does not exist.
    - **"replaceContents"**  (_optional_)
      -  If a 'regionName' has an assigned view, this parameter determines whether or not the current view will be destroyed and replaced
         or simply made visible.
    - **"channel"**  (_optional_)
      -  By default the channel is set to 'workflowChannel', but a unique channel may be specified if a developer wishes. The channel is
         used to inform a developer that an item has been fully displayed and may be used to show an item.
    - **"title"**  (_optional_)
      -  displays a string as the title to the modal
    - **"size"** (_optional_)
      - valid modal sizes include: "xlarge" | "large" | "medium"
      - default size: **"medium"**
    - **"backdrop"** (_optional_)
      - Includes a modal-backdrop element. Alternatively, specify static for a backdrop which doesn't close the modal on click.  true | false | "static"
      - default: **true**
    - **"keyboard"** (_optional_)
      - Closes the modal when escape key is pressed: true | false
      - default: **true**
    - **"callShow"** (_optional_)
      - Shows the modal when initialized: true | false
      - default: **"true"**
    - **"footerView"** (_optional_)
      - overwrites the default modal footer (close button) with a specified view
    - **"headerView"** (_optional_)
      - overwrites the default modal header (x-close button and title) with a specified view

>! **Note**: When ADK.showModal(view, modalOptions) is issued by some method other than an element with the data-toggle="modal" data-target="#modalElement" (such as through the channeling service or JavaScript), the modal must have the 'callShow' option set to true.

>! **Note**: A Workflow and a Modal cannot exist at the same time. They both occupy the same parent container and invoking ADK.showModal() while a Workflow is open will destroy the Workflow.

>! **Note**: A Workflow can be treated exactly like a Modal in the context of ADK.showModal() except that a 'regionName' must be specified, and 'data-target' and 'data-toggle' must not.

<br />

### Loading View ###

The ADK Loading View provides a standardized view instance to show during applet loading

#### ADK.Views.Loading.create() ####

```JavaScript
initialize: function(options) {
...
  this.listenTo(collection, 'sync', this.onSync);
  this.loadingView = ADK.Views.Loading.create();
...
},
onRender: function() {
...
  this.appletRegion.show(this.loadingView);
...
},
onSync: function() {
...
  this.appletRegion.show(this.appletView);
...
}
```

<br />

### Global Date Range ###

The ADK Global Date Range provides a standardized way to apply server side fetching based on selection of global date range options on the navigation bar by a user.

```JavaScript
initialize: function(options) {
...
  var self = this;
  ADK.Messaging.on('globalDate:selected', function(dateModel) {
    // This call refreshes the applet filtered by the given date field with
    // the global date range.
    self.dateRangeRefresh('observed');
  });

  // Sets this option to use the inital global date range setting of 1yr for the inital server side fetching when the coversheet is loaded for the first time.
  fetchOptions.criteria = {
      filter: this.buildJdsDateFilter('observed')
  };

},
onBeforeDestroy: function() {
  ADK.Messaging.off('globalDate:selected');
},
```
Replace 'observed' with an appropriate field of a model that represent a date.

Make sure to stop listening to the globalDate:selected event when Applet gets destroyed.

This feature assumes that a corresponding resource api supports a criteria filter syntax 'between(field, fromValue, toValue)'. E.g. between(observed,'20141025','20141025')

<br />

### Global Date Picker/Input Mask ###

The ADK Global Date Picker provides a standardized way to invoke the datepicker with masking utilizing the global convention for date formatting. The utility takes two arguments, the first of which is the reference to the input DOM element for which the datepicker and input masking is to be applied, and the second is an options object.

```JavaScript
ADK.utils.dateUtils.datepicker(selector, options);
```

For example:

```JavaScript
var currentDateTime = new Moment().format(ADK.utils.dateUtils.defaultOptions().placeholder);
ADK.utils.dateUtils.datepicker(this.$('#myDateInput'), {
  'endDate': currentDateTime
});
//Should one need to retrieve options set against an element...
var startDate = this.$('#myDateInput').data('dateUtilOptions').startDate;
```

Note in the above example that all configuration options can be retrieved with the options function call. Also note that the placeholder does not need to be explicitly set on the DOM element, but since this method expects and input element type, manual configuration is required for an icon to trigger the datepicker.

```JavaScript
$('#myDateInput').parent().find('.glyphicon-calendar').on('click', function() {
   $('#myDateInput').datepicker('show');
});
```

The following are the default options configured for both the datepicker and input mask. Start date defaults to the oldest date vista can accept. All datepicker or input mask options can be configured (please refer to each libraries documentation for more information).

```JavaScript
{
    format: 'mm/dd/yyyy',
    placeholder: 'MM/DD/YYYY',
    regex: /^(0[1-9]|1[012])\/(0[1-9]|[12][0-9]|3[01])\/(19|20)\d\d$/g,
    clearIncomplete: true,
    todayHighlight: true,
    endDate: new Moment().format('mm/dd/yyyy'),
    startDate: new Moment('01/01/1800').format('mm/dd/yyyy'),
    keyboardNavigation: false,
    onincomplete: function(e) { //Required to ensure model is sync'd to field
        $(this).val('').trigger('change');
    },
    inputmask: 'm/d/y'
}
```

<br />

## Applet Chrome ##
---

ADK's Applet Chrome refers to the optional (though **highly recommended**) applet wrapper that composes the visual container that surrounds an applet. Chrome was designed as a mechanism for consistent styling desired for most applets.

However, Chrome provides much more than simple styling. It provides access to common applet eventing, such as triggering data refreshes and toggling between applet views.

> In order to enable Chrome, an applet developer simply has to include **chromeEnabled: true** as an attribute within one of an applet's viewType objects.

```JavaScript
...
var applet = {
    id: 'sampleApplet',
    hasCSS: true,
    viewTypes: [{
        type: 'sample',
        view: new SampleView,
        chromeEnabled: true   // This enables chrome for this viewType
                              // Note: will not work with getRootView...
                              // Must use viewType array to use Chrome
    }],
    defaultViewType: 'sample'
};
...

```
**Note:** Chrome only works with an applet config that utilizes the _viewType_ array methodology for specifying views. Chrome will not work with _getRootView_.

>! Here's what Chrome would look like:
<div class="panel panel-primary" title=Conditions><div class="panel-heading grid-applet-heading"><span class=pull-left><span class=grid-refresh-button><span><button type=button class="applet-refresh-button btn btn-xs btn-link" tabindex=0 title=Refresh><i class="applet-title-button fa fa-refresh"></i> <span class=sr-only>Refresh</span></button></span></span></span> <span class=pull-right><span class=grid-titlebar></span> <span class=grid-add-button><span><button type=button class="applet-add-button btn btn-xs btn-link" tabindex=0 title="Add Item"><span class="applet-title-button fa fa-plus"><span class=sr-only>Add Item</span></span></button></span></span> <span class=grid-filter-button><span><button type=button id=grid-filter-button-applet-1 data-toggle=collapse data-target=#grid-filter-applet-1 class="applet-filter-button btn btn-xs btn-link" tabindex=0 title="Show Filter"><span class="applet-title-button fa fa-filter"><span class=sr-only>Show Filter</span></span></button></span></span> <span class=grid-options-button><span><button type=button id=grid-options-button- data-toggle=collapse data-target=#grid-options- class="applet-options-button btn btn-xs btn-link" tabindex=0 title="Show Options"><span class="applet-title-button fa fa-cog"><span class=sr-only>Show Options</span></span></button></span></span> <span class=grid-resize><span><button type=button class="applet-maximize-button btn btn-xs btn-link" tabindex=0 title="Maximize Applet"><span class="applet-title-button fa fa-expand"><span class=sr-only>Maximize Applet</span></span></button></span></span></span> <span class="center-block text-center panel-title">Applet Title</span></div><div class=appletDiv_ChromeContainer><div class="applet-view">Applet View</div></div><div class=grid-footer><span class="gs-resize-handle gs-resize-handle-both"></span></div></div>

### Using chrome with BaseDisplayApplet ###

Chrome is very easy to use with BaseDisplayApplet or a viewType that extends BaseDisplayApplet (**[any ADK.AppletView](#adk-appletviews)**) since it is already set up with many of the requirements

The table below contains the full list of elements and buttons available through Chrome and how to enable them using BaseDisplayApplet.

|  | Elements/Buttons | Description | Required to Work with BaseDisplayApplet |
|--|------------------|-------------|-----------------------------------------|
| <i class="applet-title-button fa fa-filter"></i> | **filter** | button that fires an event to toggle the display of the filter view(s) | applet's _appletOptions_ contains either attribute 'filterFields' or 'filterDateRangeField'  |
| <i class="applet-title-button fa fa-refresh"></i> | **refresh**   | button that triggers the applet view's _refresh_ method | refresh method is built in but can be overwriten by including a _'refresh'_ method to applet's _appletOptions_ |
| <i class="applet-title-button fa fa-plus"></i> | **add**  | button that triggers applet view's _onClickAdd_ method | applet's _appletOptions_ includes 'onClickAdd' method (to be called on click of **add** button) |
| <i class="applet-title-button fa fa-expand"></i> <i class="applet-title-button fa fa-close"></i> | **resize** | button that triggers 'minimize' or 'maximize' event depending on which state the applet is in | applet's screen config must have _'maximizeScreen'_ or _'fullScreen'_ attribute ([info on applet's screen config][AppletScreenConfig]) |
| | **title** | span that displays the name of the applet specified in screen config | applet's screen config object must have a _'title'- attribute|
| <i class="applet-title-button fa fa-cog"></i> | **switch viewType** | button that triggers an event that shows a switch viewType view (**only on user-derfined workspaces**) | applet is within a user-defined workspace and must have _viewTypes_ array defined in the applet's configuration |


### Using chrome with a custom view ###

If BaseDisplayApplet (or a viewType that extends it) is not being used, and instead a view is being created by extending one of Marionette's views, more must be done for the built-in elements/buttons to display in Chrome.

The following table describes the requirements for displaying the various elements/buttons provided by Chrome when creating a custom applet view from scratch (extending one of Marionette's views). For the descriptions of each element, please see table above.

|  | Elements/Buttons | Additional Requirements for inclusion in a custom view |
|--|------------------|--------------------------------------------------------|
| <i class="applet-title-button fa fa-filter"></i> | **filter** | applet view must contain at least one of the following attributes: **'filterDateRangeView'** or **'filterView'** ([read more about creating a filter view][FilterView]) and also contain a region with an id equal to _"#grid-filter-' + appletInstanceId"_ and class of _"collapse"_.
| <i class="applet-title-button fa fa-refresh"></i> | **refresh** | applet view must contain a **'eventMapper'** object with an attribute of **"refresh"** with a value of: view's method name. This method should reset/re-fetch the applet's collection in this method |
| <i class="applet-title-button fa fa-plus"></i> | **add** | applet view must contain a **'eventMapper'** object with an attribute of **"add"** with a value of: view's method name. This method should handle write-back functionality desired for the applet |
| <i class="applet-title-button fa fa-expand"></i> <i class="applet-title-button fa fa-close"></i> | **resize** | _SAME INSTRUCTIONS AS BASEDISPLAYAPPLET_ (table directly above) |
|  | **title** | _SAME INSTRUCTIONS AS BASEDISPLAYAPPLET_ (table directly above)|
|  |  |  |
| <i class="applet-title-button fa fa-cog"></i> | **switch viewType**  | _SAME INSTRUCTIONS AS BASEDISPLAYAPPLET_ (table directly above)|

Below is an example of using applet chrome without with a custom view:

```JavaScript
var dependencies = ['main/ADK', 'underscore'];
define(dependencies, onResolveDependencies);

function onResolveDependencies(ADK, _) {

  var fetchOptions = {
    resourceTitle: 'example-resource',
    pageable: true // enables infinite scrolling (makes a pageable collection)
  };

  var FilterView = Backbone.Marionette.ItemView.extend({
    template: _.template("I am a filter view!")
  });

  var SimpleItemView = Backbone.Marionette.ItemView.extend({
    template: _.template("<li>Tile: <%= title %></li>")
  });

  var CollectionView = Backbone.Marionette.CollectionView.extend({
    template: _.template("<li>Tile: <%= title %></li>"),
    childView: SimpleItemView
  });

  var SampleView = Backbone.Marionette.LayoutView.extend({
    initialize: function(options){
      this.collection = ADK.ResourceService.fetchCollection(fetchOptions);

      // creating a Collection View and giving it a collection
      this.collectionView = new CollectionView;
      this.collectionView.collection = this.collection;

      // creating a filterView to enable Applet Chrome's filter button
      this.filterView = new FilterView;
    },
    onRender: function(){
      this.collectionViewRegion.show(this.collectionView);
      this.textFilterRegion.show(this.filterView);
    },
    /*
     * this eventMapper with the attributes "refresh" and "add"
     * tied to the view's "refreshCollection" and "onClickAdd" methods
     * will enable the Applet Chrome's "refresh" and "add" buttons
     */
    eventMapper: {
      'refresh': 'refreshMethod',
      'add': 'onClickAdd'
    },
    onClickAdd: function(){
      // call writeBack 
    },
    refreshCollection: function(){
      // Example Code: clear the cached data,
      // call reset and fetch on the collection to get the updated models
      // -----------------------------------
        var collection = this.collection;

        if (collection instanceof Backbone.PageableCollection) {
            collection.fullCollection.reset();
        } else {
            collection.reset();
        }
        ADK.ResourceService.clearCache(collection.url);
        ADK.ResourceService.fetchCollection(collection.fetchOptions, collection);
      // -----------------------------------
    },
    regions: {
      collectionViewRegion: '.grid-container',
      textFilterRegion: '.grid-filter'
    },
    template: _.template("
      <div class="panel-body grid-applet-panel" id="grid-panel-{{instanceId}}">
          <div id="grid-filter-{{instanceId}}" class="collapse">
              <div class="grid-filter"></div>
          </div>
          <div class="grid-container"></div>
      </div>
    ")
  });

  var appletConfig = {
    id: 'sampleApplet',
    hasCSS: true,
    // having viewTypes array will enable the "switch viewType" button
    // in Applet Chrome on User defined workspaces
    viewTypes: [{
      type: 'base',
      view: SampleView,
      chromeEnabled: true // enabling the applet chrome for this view
    }],
    defaultViewType: 'base'
  };

  return appletConfig;
}
```

<br />

## BaseDisplayApplet ##
---
ADK.BaseDisplayApplet encapsulates the following commonly used applet functionality: **text filtering**, **date filtering**, **collection refreshing**, and **write back eventing**

When extending BaseDisplayApplet, the following attributes can be set in the view's **appletOptions** object:

| Required                                | Attribute                | Description                                                                 |
|-----------------------------------------|--------------------------|-----------------------------------------------------------------------------|
|<i class="fa fa-check-circle center"></i>| **collection**           | backbone collection that is used to populate AppletView |
|<i class="fa fa-check-circle center"></i>| **AppletView**           | view that displays the details/models of the collection |
|                                         | **toolbarView**          | view to be displayed above the AppletView |
|                                         | **filterFields**         | array of strings that point to attributes in the collection's models in which to enable text filtering |
|                                         | **filterDateRangeField** | object with string attributes (_name, label, format_) that configures how the collection is filtered by date |
|                                         | **refresh**              | method to be called for refresh collection event |
|                                         | **onClickAdd**           | method to be called for write-back event |

ADK.BaseDisplayApplet has the following methods: _intitialize_, _onRender_, _onShow_, _setAppletView_, onSync, _onError_, _loading_, _refresh_, _buildJdsDateFilter_, _dateRangeRefresh_, _showFilterView_

> **Note:**  assigning a **_super** attribute equal to ADK.BaseDisplayApplet.prototype, in the extending view, allows applet developers to augment BaseDisplayApplet's methods. If the extending view also contains a method with the same name, be sure to use the **_super** attribute to call the corresponding BaseDisplayApplet method (e.g. _this._super.[method name].apply(this, arguments)_)

The following is an example of how an applet developer would use BaseDisplayApplet

```JavaScript
var dependencies = ['main/ADK', 'underscore'];
define(dependencies, onResolveDependencies);

function onResolveDependencies(ADK, _) {

  var SimpleView = Backbone.Marionette.ItemView.extend({
      template: _.template("<li>Name: <%= name %> Age: <%= age %></li>")
  });

  var CollectionView = Backbone.Marionette.CollectionView.extend({
    childView: SimpleView,
    tagName: "ul"
  });

  var ToolBarView = Backbone.Marionette.ItemView.extend({
    template: _.template("<div>I am a ToolBarView</div>")
  });

  var SampleView = ADK.BaseDisplayApplet.extend({
    // use super to reference ADK.BaseDisplayApplet's methods
    super: ADK.BaseDisplayApplet.prototype,
    initialize: function(options){
      /* always need to define this.appletOptions in the initialize
       * with a minimum of the required attributes
       *
       * see the above table for attributes that are required
       */
      this.appletOptions = {
        collection: new Backbone.Collection([
          {name: "Tim", age: 5, dob: "20100101"},
          {name: "Ida", age: 26, dob: "19890101"},
          {name: "Rob", age: 55, dob: "19600101"}
        ]),
        AppletView: CollectionView,
        filterFields: ['name', 'age'],
        filterDateRangeField: {
          name: "dob",
          label: "Date of Birth",
          format: "YYYYMMDD"
        },
        toolbarView: new ToolBarView
      }

      // calling ADK.BaseDisplayApplet's initialize method
      this._super.initialize.apply(this, arguments);
    }
  });

  var appletConfig = {
    id: 'sampleApplet',
    hasCSS: true,
    viewTypes: [{
      type: 'base',
      view: SampleView
    }],
    defaultViewType: 'base'
  };

  return appletConfig;
}
```


<br />

## ADK AppletViews ##
---
ADK.AppletViews is an object that contains predefined views extended from **ADK.BaseDisplayApplet**

Functionality provided by these views through extending BaseDisplayApplet: **text filtering**, **date filtering**, **collection refresh**, and **write-back eventing**

**Note:** Many of the predefined viewTypes below are a type of "gist" view. With a gist view, the intent is to display meaningful data in a very quick time in order to lessen the time needed to be spent by users looking at data. This can be done in various ways, and can include grouping, graphical representations, popovers, etc... In contrast, an applet using the GridView type, or one similar to it, would focus on displaying more inclusive and explicit data sets.


> Each of these predefined applet views can be extended and customized by an applet developer by setting the view's _appletOptions_ object (**this.appletOptions** ... See examples below)

### GridView ###
ADK.AppletViews.GridView

GridView is a straight forward DataGrid applet. The applet's collection is rendered in table format with rows and columns, with built in text filtering (from BaseDisplayApplet) and column sorting (provided the appropriate requirements are met).

Functionality provided by GridView in addition to that already provided by BaseDisplayApplet are as follows:
- **infinite scrolling** : if the collection passed in with appletOptions is of type Backbone.PageableCollection
- **column sorting** : enabled by default since passing in an appletOptions.columns attribute is a requirement for GridView

Below are the addiontial **appletOptions** available/required with GridView:

| Required     | Option          | Type   |Description                                                                                                                               |
|--------------|-----------------|--------|------------------------------------------------------------------------------------------------------------------------------------------|
|              | **onClickRow**  | method | handles event when user clicks a row.     |
|              | **detailsView** | view   | if specified and onClickRow is not in appletOptions, will be shown between the row clicked on and the next row. |
|<i class="fa fa-check-circle note center">*</i> | **columns** | array of objects | specified column objects are used to config what columns to display |
|<i class="fa fa-check-circle note center">*</i> | **summaryColumns** | array of objects | specified column objects are used to config what columns to display (on a screen with "fullScreen: false" specified in the applet's screen config) |
|<i class="fa fa-check-circle note center">*</i> | **fullScreenColumns** | array of objects | specified column objects are used to config what columns to display (on a screen with "fullScreen: true" specified in the applet's screen config) |
|              | **groupable** | boolean | (default: _false_) set to true to enable the groupable behavior |

>> **Note:** specifying neither onClickRow nor detailsView will result in nothing happening when a row is clicked, unless specified in an applet event.

>> ** <i class="fa fa-check-circle note">*</i>**: it is required to either have a **columns** or **summaryColumns** or **fullScreenColumns** attribute specified. (_summaryColumns_ and _fullScreenColumns_ take precedence over the _columns_ atrribute) All three attributes correspond to an array of objects that have the following attributes, listed in the box below:

>! ####**Column** Object Attributes:####
- **name** : Model key mapped to collection
- **label** : Column heading displayed in table
- **cell** : [Cell type](http://backgridjs.com/ref/cell.html) (default "string")
- **template** : Optional handlebars template for use with cell: "handlebars"
- **sortable** : Enable sorting (default true)
- **renderable** : Enable rendering (default true)
- **groupable** : Enable grouping (default false)
- **groupableOptions** : object with grouping options

>!! ###Grouping in GridView###
In addition to grouping rows, two other pieces of grouping options.
- Group Header - This is a row that is inserted at the top of the group. Clicking on the row either hides all of the rows in that group, providing a count in the header row, or it shows all of the rows in that group.
- Clicking on column headers changes the group by category - When a column header is clicked, the grid is regrouped by that column.
    For example, when the Entered By column is clicked on, the grid will group all of the providers with the same name together.
    Note: On the third click of a column header, the grid reverts back to what it looked like before you started clicking on headers (the same view that was loaded with the page)
To enable the behavior, several things need to be done. Firstly, appletOptions.groupable needs to be true.
The second thing that needs to be done, is that the columns need to be configured properly.
Much of the grouping functionality is modeled after Backgrid's sorting behavior.
>! ####Column.**groupableOptions** Attributes:####
>! - **primary** : (_optional_) (default: _false_) : When a column is marked primary, when the grid is loaded, refreshed, or on the '3rd click', the grid is grouped by this column. At least one column should be marked as primary innerSort - In practice, this isn't optional. The requirements are that the groups should be sorted in reverse chronological order (most recent at the top). In theory, it is optional. The group sort will be the insertion order into the collection without it. (needs to be tested).
>! - **groupByFunction** : (_optional_) : Defaults to the name of the column. You can pass in an optional function. Dictates the sorting key - all rows that return the same result of this function will be grouped together.  You can access the model via collectionElement.model. Handy for grouping by date ranges. (year & month for example)
>! - **groupByRowFormatter** : (_optional_) : Defaults to the name of the column. Whatever this function returns is what will be displayed as the group header.

The following is a sample implementation of a GridView applet
```JavaScript
var dependencies = ['main/ADK', 'underscore'];
define(dependencies, onResolveDependencies);

function onResolveDependencies(ADK, _) {

    var sampleColumns = [{      // Specifies which columns are included and enables column sorting
      name: 'name',           // field mapped to in collection
      label: 'Name',          // displayed in the table
      cell: 'string'
    }, { // this column is not groupable or sortable. Clicking on the column will do nothing.
      name: 'description',
      label: 'Description',
      cell: 'string',
      sortable: false
    }, {
      name: 'observedDate',
      label: 'Date',
      cell: 'string'
    }, {
      //this column takes 2 optional groupableOptions, groupByFunction & groupByRowFormatter
      name: 'kind',
      label: 'Type',
      cell: 'string',
      groupable:true,
      groupableOptions: {
          primary:true,  //When a column is marked primary, when the grid is loaded, refreshed, or on the '3rd click', the grid is grouped by this column
          innerSort: "activityDateTime", //this is reverse chronological (desc) order.
      }
    }, {
      //this column takes 2 optional groupableOptions, groupByFunction & groupByRowFormatter
      //this is because we want to group by year & month.
      name: 'activityDateTime',
      label: 'Date & Time',
      cell: 'handlebars',
      template: formatDateTemplate,
      groupable:true,
      groupableOptions: {
        innerSort: "activityDateTime", //in practice, this isn't optional. In theory it is (not tested though)
        groupByFunction: function(collectionElement) {
            return -collectionElement.model.get("activityDateTime").substr(0,6);
        },
        //this takes the item returned by the groupByFunction
        groupByRowFormatter: function(item) {
            return moment(item, "YYYYMM").format("MMMM YYYY");
        }
      }
    }];

   var fetchOptions = {
        resourceTitle: 'example-resource',
        pageable: true                    // enables infinite scrolling (makes a pageable collection)
    };

  var SampleGridView = ADK.GridView.extend({
    // use super to reference ADK.GridViews's methods
    super: ADK.GridView.prototype,
    initialize: function(options){
      this.appletOptions = {
        columns: sampleColumns,
        collection: ADK.PatientRecordService.fetchCollection(fetchOptions),
        filterFields: ['name', 'description'],
        filterDateRangeField: {
          name: "observedDate",
          label: "Date",
          format: "YYYYMMDD"
        },
        onClickRow: this.sampleOnClickRowHandler
      }

      // calling ADK.GridView's initialize method
      this._super.initialize.apply(this, arguments);
    },
    // event handler for row click. Opens a modal with the detailed view
    sampleOnClickRowHandler : function(model, event) {
      var view = new ModalView({model: model});
      var modalOptions = {
        title: 'Details'
      }
      ADK.showModal(view, modalOptions);
    }
  });

  var appletConfig = {
    id: 'sampleGridApplet',
    hasCSS: true,
    viewTypes: [{
      type: 'grid',
      view: SampleGridView,
      chromeEnabled: true
    }],
    defaultViewType: 'grid'
  };

  return appletConfig;
}

```

<br />

### PillsGistView ###
ADK.AppletViews.PillsGistView

PillsGistView is a simple gist view that displays only the amount of data required to differentiate between other entries (ie. An allergies applet only displaying the name of an allergy per pill) in a pill shaped button/container.

Below are the addiontial **appletOptions** available/required with PillsGistView:

| Required     | Option               | Type   |Description                                                                                                                               |
|--------------|----------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------|
|<i class="fa fa-check-circle center"></i> | **gistModel**        | array  | array of objects with attributes id and field (ie. [{id: 'name', field: 'summary'}]).|
|              | **collectionParser** | method | returns a manipulated/parsed collection |

The following is a sample implementation of a PillsGistView sample applet.

```JavaScript
var dependencies = ['main/ADK', 'underscore'];
define(dependencies, onResolveDependencies);

function onResolveDependencies(ADK, _) {

    var fetchOptions = {
        resourceTitle: 'example-resource'
    };

    var samplePillsGistView = ADK.AppletViews.PillsGistView.extend({
        ._super:  ADK.AppletViews.PillsGistView.prototype,
        initialize: function(options) {
            var self = this;
            this.appletOptions = {
                filterFields: ["name"],
                filterDateRangeField: {
                  name: "dob",
                  label: "Date of Birth",
                  format: "YYYYMMDD"
                },
                collectionParser: self.transformCollection,
                gistModel: self.gistModel,
                collection: ADK.PatientRecordService.fetchCollection(fetchOptions)
            };
            this._super.initialize.apply(this, arguments);
        },
        transformCollection: function(collection) {
            return collection;
        },
        gistModel: [{
              id: 'name',
              field: 'name'
          }]
        }
    });
    var appletConfig = {
        id: 'samplePillsGistApplet',
        hasCSS: true,
        viewTypes: [{
          type: 'gist',
          view: samplePillsGistView
        }],
        defaultViewType: 'gist'
  };

  return appletConfig;
}

```

<br />

### InterventionsGistView ###
ADK.AppletViews.InterventionsGistView

Below are the addiontial **appletOptions** available/required with InterventionsGistView:

| Required     | Option               | Type   |Description                                                                                                                               |
|--------------|----------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------|
|<i class="fa fa-check-circle center"></i>| **gistModel** | array  | array of objects with attributes id and field (ie. [{id: 'name', field: 'summary'}]). |
|              | **collectionParser** | method | returns a manipulated/parsed collection |
|              | **gistHeaders**      | object | configruation object for column headers which will be displayed and sortable. |
|              | **onClickRow**       | method | event handler for when user clicks on a row. Will default to opening a popover containing most recent events |

The following is a sample implementation of a InterventionsGistView sample applet.

```JavaScript
var dependencies = ['main/ADK', 'underscore'];
define(dependencies, onResolveDependencies);

function onResolveDependencies(ADK, _) {

    var fetchOptions = {
        resourceTitle: 'example-resource'
    };

    var sampleInterventionsGistView = ADK.AppletViews.InterventionsGistView.extend({
        ._super:  ADK.AppletViews.InterventionsGistView.prototype,
        initialize: function(options) {
            var self = this;
            this.appletOptions = {
                filterFields: ["name"],
                filterDateRangeField: {
                  name: "dob",
                  label: "Date of Birth",
                  format: "YYYYMMDD"
                },
                gistHeaders: {
                  name: {
                    title: 'Name',
                    sortable: true,
                    sortType: 'alphabetical'
                  },
                  description: {
                    title: 'Description',
                    sortable: false
                  },
                  graphic: {
                      title: '',
                      sortable: true,
                      sortType: 'alphabetical'
                  },
                  age: {
                      title: 'Age',
                      sortable: true,
                      sortType: 'date'
                  },
                  count: {
                      title: 'Refills',
                      sortable: true,
                      sortType: 'numerical'
                  }
                },
                collectionParser: self.transformCollection,
                gistModel: self.gistModel,
                collection: ADK.PatientRecordService.fetchCollection(fetchOptions)
            };
            this._super.initialize.apply(this, arguments);
        },
        transformCollection: function(collection) {
            return collection;
        },
        gistModel: [{
              id: 'name',
              field: 'name'
          }]
        }
    });
    var appletConfig = {
        id: 'sampleInterventionsGistApplet',
        hasCSS: true,
        viewTypes: [{
          type: 'gist',
          view: sampleInterventionsGistView
        }],
        defaultViewType: 'gist'
  };

  return appletConfig;
}

```

<br />

### EventsGistView ###
ADK.AppletViews.EventsGistView

The EventsGistView viewType is a more complicated gist featuring clumping of recurring data points (ie. if a patient gets a flu shot every year). Another feature of this gist is an in-line graph that displays ocurrences over time, useful for the user to determine quickly how many and how recently these events occur. This gist view also displays events in a column/row structure with built in column sorting.

Below are the addiontial **appletOptions** available/required with EventsGistView:

| Required     | Option               | Type   |Description                                                                                                                               |
|--------------|----------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------|
|<i class="fa fa-check-circle center"></i>| **gistModel** | array  | array of objects with attributes id and field (ie. [{id: 'name', field: 'summary'}]). |
|              | **collectionParser** | method | returns a manipulated/parsed collection |
|              | **gistHeaders**      | object | configruation object for column headers which will be displayed and sortable. |
|              | **onClickRow**       | method | event handler for when user clicks on a row. Will default to opening a popover containing most recent events |

The following is a sample implementation of a EventsGistView sample applet.

```JavaScript
var dependencies = ['main/ADK', 'underscore'];
define(dependencies, onResolveDependencies);

function onResolveDependencies(ADK, _) {

    var fetchOptions = {
        resourceTitle: 'example-resource'
    };

    var sampleEventsGistView = ADK.AppletViews.EventsGistView.extend({
        ._super:  ADK.AppletViews.EventsGistView.prototype,
        initialize: function(options) {
            var self = this;
            this.appletOptions = {
                filterFields: ["name"],
                filterDateRangeField: {
                  name: "dob",
                  label: "Date of Birth",
                  format: "YYYYMMDD"
                },
                gistHeaders: {
                  name: {
                    title: 'Name',
                    sortable: true,
                    sortType: 'alphabetical',
                    key: 'groupName'
                  },
                  acuityName: {
                    title: 'Acuity',
                    sortable: true,
                    sortType: 'alphabetical',
                    key: 'acuityName'
                  },
                  graph: {
                    title: '',
                    sortable: false,
                  },
                  itemsInGraphCount: {
                    title: 'Hx Occurrence',
                    sortable: true,
                    sortType: 'numeric',
                    key: 'encounterCount'
                  },
                  age: {
                    title: 'Age',
                    sortable: true,
                    sortType: 'date',
                    key: 'timeSinceDateString'
                  }
                },
                collectionParser: self.transformCollection,
                gistModel: self.gistModel,
                collection: ADK.PatientRecordService.fetchCollection(fetchOptions)
            };
            this._super.initialize.apply(this, arguments);
        },
        transformCollection: function(collection) {
            return collection;
        },
        gistModel: [{
              id: 'name',
              field: 'name'
          }]
        }
    });
    var appletConfig = {
        id: 'sampleEventsGistApplet',
        hasCSS: true,
        viewTypes: [{
          type: 'gist',
          view: sampleEventsGistView
        }],
        defaultViewType: 'gist'
  };

  return appletConfig;
}

```

<br />

### ObservationsGistView ###
ADK.AppletViews.ObservationsGistView

> **Note**: Not yet supported!

<br />


## ADK Views ##
---

ADK includes several build in, ready-to-use views that are accessible.  Each of the ADK views returns an object with an **create** method that returns a new instance of the view.  The following is a list of currently support views:


>! ### Error View ###
```JavaScript
ADK.Views.Error.create({
  model: new Backbone.Model(resp)
});
```
Returns an ItemView that displays an appropriate error message to the user.

<span />

>! ### Loading View ###
```JavaScript
ADK.Views.Loading.create();
```
Returns an ItemView that displays a Loading spinner and message.



[adkSourceCode]: https://git.vistacore.us/git/adk.git
[ehmpuiSourceCode]: https://git.vistacore.us/git/ehmp-ui.git
[standardizedIdeWikiPage]: https://wiki.vistacore.us/display/VACORE/Team+Standardized+IDE+for+JavaScript+Development
[workspaceSetupWikiPage]: https://wiki.vistacore.us/display/VACORE/Creating+DevOps+workspace+environment
[sublimeWebsite]: http://www.sublimetext.com/3
[sublimeSettingsWikiPage]: https://wiki.vistacore.us/x/RZsZ
[adkBuildJenkins]: https://build.vistacore.us/view/adk/view/Next%20Branch/
[bsCSS]: http://getbootstrap.com/css/
[bsComponents]: http://getbootstrap.com/components/
[bsJQ]: http://getbootstrap.com/javascript/
[backboneWebPage]: http://backbonejs.org/
[marionetteWebPage]: https://github.com/marionettejs/backbone.marionette/tree/master/docs
[requireJsWebPage]: http://requirejs.org/
[amdWebPage]: http://requirejs.org/docs/whyamd.html
[handlebarsWebPage]: http://handlebarsjs.com/
[underscoreFilterWebPage]: http://underscorejs.org/#filter
[BackboneRadio]: https://github.com/marionettejs/backbone.radio
[sass]: http://sass-lang.com/
[AppletScreenConfig]: ./getting-started.html#applet-screen-config-object
[FilterView]: ./using-adk.html/#filter-view

</xmp>

<script src="./navigation-config.js"></script>
<script src="../_assets/libs/strapdown/dist/strapdown.js"></script>
</html>
